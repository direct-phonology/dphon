<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>dphon.index API documentation</title>
<meta name="description" content="Tools for building indices of document data." />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>dphon.index</code></h1>
</header>
<section id="section-intro">
<p>Tools for building indices of document data.</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">#!/usr/bin/env python
# -*- coding: utf-8 -*-
&#34;&#34;&#34;Tools for building indices of document data.&#34;&#34;&#34;

from dphon.g2p import OOV_PHONEMES
import logging
from abc import ABC, abstractmethod
from typing import Callable, Hashable, Iterable, Iterator, List, Tuple, TypeVar, Generic

from spacy.language import Language
from spacy.tokens import Doc, Span
from spacy.lookups import Table

K = TypeVar(&#34;K&#34;)                    # type for keys stored in the index
V = TypeVar(&#34;V&#34;)                    # type for values stored in the index


class Index(ABC, Generic[K, V]):
    &#34;&#34;&#34;Abstract base class that indexes arbitrary document data.

    Subclasses are intended for use as spaCy pipeline components. Docs will be
    passed through the component unmodified, storing some data in an external
    index maintained by the component for later use. The particular indexing 
    strategy is implementation-defined.
    
    Args:
        nlp: a spaCy language model.
    &#34;&#34;&#34;

    def __init__(self, nlp: Language):
        logging.info(f&#34;using {self.__class__}&#34;)

    @abstractmethod
    def __call__(self, doc: Doc) -&gt; Doc:
        &#34;&#34;&#34;Index a single spaCy Doc. Should not mutate the Doc.&#34;&#34;&#34;
        return doc

    @abstractmethod
    def __contains__(self, key: K) -&gt; bool:
        &#34;&#34;&#34;Check if a key is in the index.&#34;&#34;&#34;
        raise NotImplementedError

    @abstractmethod
    def __getitem__(self, key: K) -&gt; Iterable[V]:
        &#34;&#34;&#34;Return all values indexed at a given key.&#34;&#34;&#34;
        raise NotImplementedError

    @abstractmethod
    def __iter__(self) -&gt; Iterator[Tuple[K, List[V]]]:
        &#34;&#34;&#34;Return a (k, v) iterator over all entries in the index.&#34;&#34;&#34;
        raise NotImplementedError

    @abstractmethod
    def filter(self, fn: Callable[[Tuple[K, List[V]]], bool]) -&gt; Iterator[Tuple[K, List[V]]]:
        &#34;&#34;&#34;Return a (k, v) iterator over all entries which match a predicate.&#34;&#34;&#34;
        raise NotImplementedError

    @abstractmethod
    def __len__(self) -&gt; int:
        &#34;&#34;&#34;Get the total number of keys in the index.&#34;&#34;&#34;
        raise NotImplementedError

    @property
    @abstractmethod
    def size(self) -&gt; int:
        &#34;&#34;&#34;Get the total number of values in the index.&#34;&#34;&#34;
        raise NotImplementedError


class LookupsIndex(Index[Hashable, V], Generic[V]):
    &#34;&#34;&#34;Index using a `spacy.lookups.Table` to store document data.

    Subclasses must implement `_get_vals()` and `_get_keys()` to define how data
    is to be extracted from documents and indexed. `_get_vals()` returns an
    iterable of all values from a document that should be indexed, while
    `_get_keys()` returns the key for a single value.

    Data is indexed as a `spacy.lookups.Table`, which is a subclass of 
    `collections.OrderedDict` with a bloom filter applied to speed up querying.

    Args:
        nlp: a spaCy language model.
    &#34;&#34;&#34;

    _table: Table       # uses spaCy&#39;s lookup tables (bloom filtered dict)
    _size: int          # tracker for total number of values in index

    def __init__(self, nlp: Language) -&gt; None:
        self._table = nlp.vocab.lookups.add_table(&#34;index&#34;)
        self._size = 0
        super().__init__(nlp)

    def __call__(self, doc: Doc) -&gt; Doc:
        &#34;&#34;&#34;Extract values from a doc with _get_vals and index with _get_key.&#34;&#34;&#34;
        for val in self._get_vals(doc):
            key = self._get_key(val)
            try:
                self._table.get(key).append(val)
            except AttributeError:
                self._table.set(key, [val])
            self._size += 1
        return super().__call__(doc)

    def __len__(self) -&gt; int:
        &#34;&#34;&#34;Get the total number of keys in the index.&#34;&#34;&#34;
        return len(self._table)

    def __contains__(self, key: K) -&gt; bool:
        &#34;&#34;&#34;Check if a key is in the index.&#34;&#34;&#34;
        return key in self._table

    def __getitem__(self, key: K) -&gt; List[V]:
        &#34;&#34;&#34;Return a list of all values indexed at a given key.&#34;&#34;&#34;
        return self._table.get(key)

    def __iter__(self) -&gt; Iterator[Tuple[K, List[V]]]:
        &#34;&#34;&#34;Return a (k, v) iterator over all entries in the index.&#34;&#34;&#34;
        return (entry for entry in self._table.items())

    @abstractmethod
    def _get_vals(self, doc: Doc) -&gt; Iterable[V]:
        &#34;&#34;&#34;Get all the values to be indexed from a Doc.&#34;&#34;&#34;
        raise NotImplementedError

    @abstractmethod
    def _get_key(self, val: V) -&gt; Hashable:
        &#34;&#34;&#34;Get the key to index a particular value.&#34;&#34;&#34;
        raise NotImplementedError

    def filter(self, fn: Callable[[Tuple[K, List[V]]], bool]) -&gt; Iterator[Tuple[K, List[V]]]:
        &#34;&#34;&#34;Return a (k, v) iterator over all entries which match a predicate.&#34;&#34;&#34;
        return (entry for entry in iter(self) if fn(entry))

    @property
    def size(self) -&gt; int:
        &#34;&#34;&#34;Get the total number of values in the index.&#34;&#34;&#34;
        return self._size


class NgramPhonemesLookupsIndex(LookupsIndex[Span]):
    &#34;&#34;&#34;Index of phonetic n-grams using a `spacy.lookups.Table`.
    
    Each key in the index is the phonetic content of a unique document n-gram as
    a string. Values stored at this key are `spacy.tokens.Span` objects 
    representing the document locations where this phonetic content occurred.
    
    - Requires an n-gram component (see `dphon.ngrams`) to break document text
    into n-grams.
    - Requires a grapheme-to-phoneme model (see `dphon.g2p`) to retrieve phonetic
    content of n-grams.
    &#34;&#34;&#34;

    def _get_vals(self, doc: Doc) -&gt; Iterator[Span]:
        &#34;&#34;&#34;Iterator over phonetic ngrams in the doc.

        Discards any ngrams containing non-voiced content, and any for which
        the g2p model did not have phonetic information.
        &#34;&#34;&#34;

        for ngram in doc._.ngrams:
            if ngram.text.isalpha() and OOV_PHONEMES not in ngram._.phonemes:
                yield ngram

    def _get_key(self, val: Span) -&gt; str:
        &#34;&#34;&#34;All phonetic content of an ngram as a string.&#34;&#34;&#34;
        return &#34;&#34;.join(val._.phonemes)


@Language.factory(&#34;ngram_phonemes_index&#34;)
def create_ngram_phonemes_lookup_index(nlp: Language, name: str) -&gt; NgramPhonemesLookupsIndex:
    return NgramPhonemesLookupsIndex(nlp)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="dphon.index.create_ngram_phonemes_lookup_index"><code class="name flex">
<span>def <span class="ident">create_ngram_phonemes_lookup_index</span></span>(<span>nlp: spacy.language.Language, name: str) ‑> <a title="dphon.index.NgramPhonemesLookupsIndex" href="#dphon.index.NgramPhonemesLookupsIndex">NgramPhonemesLookupsIndex</a></span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@Language.factory(&#34;ngram_phonemes_index&#34;)
def create_ngram_phonemes_lookup_index(nlp: Language, name: str) -&gt; NgramPhonemesLookupsIndex:
    return NgramPhonemesLookupsIndex(nlp)</code></pre>
</details>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="dphon.index.Index"><code class="flex name class">
<span>class <span class="ident">Index</span></span>
<span>(</span><span>nlp: spacy.language.Language)</span>
</code></dt>
<dd>
<div class="desc"><p>Abstract base class that indexes arbitrary document data.</p>
<p>Subclasses are intended for use as spaCy pipeline components. Docs will be
passed through the component unmodified, storing some data in an external
index maintained by the component for later use. The particular indexing
strategy is implementation-defined.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>nlp</code></strong></dt>
<dd>a spaCy language model.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Index(ABC, Generic[K, V]):
    &#34;&#34;&#34;Abstract base class that indexes arbitrary document data.

    Subclasses are intended for use as spaCy pipeline components. Docs will be
    passed through the component unmodified, storing some data in an external
    index maintained by the component for later use. The particular indexing 
    strategy is implementation-defined.
    
    Args:
        nlp: a spaCy language model.
    &#34;&#34;&#34;

    def __init__(self, nlp: Language):
        logging.info(f&#34;using {self.__class__}&#34;)

    @abstractmethod
    def __call__(self, doc: Doc) -&gt; Doc:
        &#34;&#34;&#34;Index a single spaCy Doc. Should not mutate the Doc.&#34;&#34;&#34;
        return doc

    @abstractmethod
    def __contains__(self, key: K) -&gt; bool:
        &#34;&#34;&#34;Check if a key is in the index.&#34;&#34;&#34;
        raise NotImplementedError

    @abstractmethod
    def __getitem__(self, key: K) -&gt; Iterable[V]:
        &#34;&#34;&#34;Return all values indexed at a given key.&#34;&#34;&#34;
        raise NotImplementedError

    @abstractmethod
    def __iter__(self) -&gt; Iterator[Tuple[K, List[V]]]:
        &#34;&#34;&#34;Return a (k, v) iterator over all entries in the index.&#34;&#34;&#34;
        raise NotImplementedError

    @abstractmethod
    def filter(self, fn: Callable[[Tuple[K, List[V]]], bool]) -&gt; Iterator[Tuple[K, List[V]]]:
        &#34;&#34;&#34;Return a (k, v) iterator over all entries which match a predicate.&#34;&#34;&#34;
        raise NotImplementedError

    @abstractmethod
    def __len__(self) -&gt; int:
        &#34;&#34;&#34;Get the total number of keys in the index.&#34;&#34;&#34;
        raise NotImplementedError

    @property
    @abstractmethod
    def size(self) -&gt; int:
        &#34;&#34;&#34;Get the total number of values in the index.&#34;&#34;&#34;
        raise NotImplementedError</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>abc.ABC</li>
<li>typing.Generic</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="dphon.index.LookupsIndex" href="#dphon.index.LookupsIndex">LookupsIndex</a></li>
</ul>
<h3>Instance variables</h3>
<dl>
<dt id="dphon.index.Index.size"><code class="name">var <span class="ident">size</span> : int</code></dt>
<dd>
<div class="desc"><p>Get the total number of values in the index.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
@abstractmethod
def size(self) -&gt; int:
    &#34;&#34;&#34;Get the total number of values in the index.&#34;&#34;&#34;
    raise NotImplementedError</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="dphon.index.Index.filter"><code class="name flex">
<span>def <span class="ident">filter</span></span>(<span>self, fn: Callable[[Tuple[~K, List[~V]]], bool]) ‑> Iterator[Tuple[~K, List[~V]]]</span>
</code></dt>
<dd>
<div class="desc"><p>Return a (k, v) iterator over all entries which match a predicate.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@abstractmethod
def filter(self, fn: Callable[[Tuple[K, List[V]]], bool]) -&gt; Iterator[Tuple[K, List[V]]]:
    &#34;&#34;&#34;Return a (k, v) iterator over all entries which match a predicate.&#34;&#34;&#34;
    raise NotImplementedError</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="dphon.index.LookupsIndex"><code class="flex name class">
<span>class <span class="ident">LookupsIndex</span></span>
<span>(</span><span>nlp: spacy.language.Language)</span>
</code></dt>
<dd>
<div class="desc"><p>Index using a <code>spacy.lookups.Table</code> to store document data.</p>
<p>Subclasses must implement <code>_get_vals()</code> and <code>_get_keys()</code> to define how data
is to be extracted from documents and indexed. <code>_get_vals()</code> returns an
iterable of all values from a document that should be indexed, while
<code>_get_keys()</code> returns the key for a single value.</p>
<p>Data is indexed as a <code>spacy.lookups.Table</code>, which is a subclass of
<code>collections.OrderedDict</code> with a bloom filter applied to speed up querying.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>nlp</code></strong></dt>
<dd>a spaCy language model.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class LookupsIndex(Index[Hashable, V], Generic[V]):
    &#34;&#34;&#34;Index using a `spacy.lookups.Table` to store document data.

    Subclasses must implement `_get_vals()` and `_get_keys()` to define how data
    is to be extracted from documents and indexed. `_get_vals()` returns an
    iterable of all values from a document that should be indexed, while
    `_get_keys()` returns the key for a single value.

    Data is indexed as a `spacy.lookups.Table`, which is a subclass of 
    `collections.OrderedDict` with a bloom filter applied to speed up querying.

    Args:
        nlp: a spaCy language model.
    &#34;&#34;&#34;

    _table: Table       # uses spaCy&#39;s lookup tables (bloom filtered dict)
    _size: int          # tracker for total number of values in index

    def __init__(self, nlp: Language) -&gt; None:
        self._table = nlp.vocab.lookups.add_table(&#34;index&#34;)
        self._size = 0
        super().__init__(nlp)

    def __call__(self, doc: Doc) -&gt; Doc:
        &#34;&#34;&#34;Extract values from a doc with _get_vals and index with _get_key.&#34;&#34;&#34;
        for val in self._get_vals(doc):
            key = self._get_key(val)
            try:
                self._table.get(key).append(val)
            except AttributeError:
                self._table.set(key, [val])
            self._size += 1
        return super().__call__(doc)

    def __len__(self) -&gt; int:
        &#34;&#34;&#34;Get the total number of keys in the index.&#34;&#34;&#34;
        return len(self._table)

    def __contains__(self, key: K) -&gt; bool:
        &#34;&#34;&#34;Check if a key is in the index.&#34;&#34;&#34;
        return key in self._table

    def __getitem__(self, key: K) -&gt; List[V]:
        &#34;&#34;&#34;Return a list of all values indexed at a given key.&#34;&#34;&#34;
        return self._table.get(key)

    def __iter__(self) -&gt; Iterator[Tuple[K, List[V]]]:
        &#34;&#34;&#34;Return a (k, v) iterator over all entries in the index.&#34;&#34;&#34;
        return (entry for entry in self._table.items())

    @abstractmethod
    def _get_vals(self, doc: Doc) -&gt; Iterable[V]:
        &#34;&#34;&#34;Get all the values to be indexed from a Doc.&#34;&#34;&#34;
        raise NotImplementedError

    @abstractmethod
    def _get_key(self, val: V) -&gt; Hashable:
        &#34;&#34;&#34;Get the key to index a particular value.&#34;&#34;&#34;
        raise NotImplementedError

    def filter(self, fn: Callable[[Tuple[K, List[V]]], bool]) -&gt; Iterator[Tuple[K, List[V]]]:
        &#34;&#34;&#34;Return a (k, v) iterator over all entries which match a predicate.&#34;&#34;&#34;
        return (entry for entry in iter(self) if fn(entry))

    @property
    def size(self) -&gt; int:
        &#34;&#34;&#34;Get the total number of values in the index.&#34;&#34;&#34;
        return self._size</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="dphon.index.Index" href="#dphon.index.Index">Index</a></li>
<li>abc.ABC</li>
<li>typing.Generic</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="dphon.index.NgramPhonemesLookupsIndex" href="#dphon.index.NgramPhonemesLookupsIndex">NgramPhonemesLookupsIndex</a></li>
</ul>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="dphon.index.Index" href="#dphon.index.Index">Index</a></b></code>:
<ul class="hlist">
<li><code><a title="dphon.index.Index.filter" href="#dphon.index.Index.filter">filter</a></code></li>
<li><code><a title="dphon.index.Index.size" href="#dphon.index.Index.size">size</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="dphon.index.NgramPhonemesLookupsIndex"><code class="flex name class">
<span>class <span class="ident">NgramPhonemesLookupsIndex</span></span>
<span>(</span><span>nlp: spacy.language.Language)</span>
</code></dt>
<dd>
<div class="desc"><p>Index of phonetic n-grams using a <code>spacy.lookups.Table</code>.</p>
<p>Each key in the index is the phonetic content of a unique document n-gram as
a string. Values stored at this key are <code>spacy.tokens.Span</code> objects
representing the document locations where this phonetic content occurred.</p>
<ul>
<li>Requires an n-gram component (see <code><a title="dphon.ngrams" href="ngrams.html">dphon.ngrams</a></code>) to break document text
into n-grams.</li>
<li>Requires a grapheme-to-phoneme model (see <code><a title="dphon.g2p" href="g2p.html">dphon.g2p</a></code>) to retrieve phonetic
content of n-grams.</li>
</ul></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class NgramPhonemesLookupsIndex(LookupsIndex[Span]):
    &#34;&#34;&#34;Index of phonetic n-grams using a `spacy.lookups.Table`.
    
    Each key in the index is the phonetic content of a unique document n-gram as
    a string. Values stored at this key are `spacy.tokens.Span` objects 
    representing the document locations where this phonetic content occurred.
    
    - Requires an n-gram component (see `dphon.ngrams`) to break document text
    into n-grams.
    - Requires a grapheme-to-phoneme model (see `dphon.g2p`) to retrieve phonetic
    content of n-grams.
    &#34;&#34;&#34;

    def _get_vals(self, doc: Doc) -&gt; Iterator[Span]:
        &#34;&#34;&#34;Iterator over phonetic ngrams in the doc.

        Discards any ngrams containing non-voiced content, and any for which
        the g2p model did not have phonetic information.
        &#34;&#34;&#34;

        for ngram in doc._.ngrams:
            if ngram.text.isalpha() and OOV_PHONEMES not in ngram._.phonemes:
                yield ngram

    def _get_key(self, val: Span) -&gt; str:
        &#34;&#34;&#34;All phonetic content of an ngram as a string.&#34;&#34;&#34;
        return &#34;&#34;.join(val._.phonemes)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="dphon.index.LookupsIndex" href="#dphon.index.LookupsIndex">LookupsIndex</a></li>
<li><a title="dphon.index.Index" href="#dphon.index.Index">Index</a></li>
<li>abc.ABC</li>
<li>typing.Generic</li>
</ul>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="dphon.index.LookupsIndex" href="#dphon.index.LookupsIndex">LookupsIndex</a></b></code>:
<ul class="hlist">
<li><code><a title="dphon.index.LookupsIndex.filter" href="#dphon.index.Index.filter">filter</a></code></li>
<li><code><a title="dphon.index.LookupsIndex.size" href="#dphon.index.Index.size">size</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="dphon" href="index.html">dphon</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="dphon.index.create_ngram_phonemes_lookup_index" href="#dphon.index.create_ngram_phonemes_lookup_index">create_ngram_phonemes_lookup_index</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="dphon.index.Index" href="#dphon.index.Index">Index</a></code></h4>
<ul class="">
<li><code><a title="dphon.index.Index.filter" href="#dphon.index.Index.filter">filter</a></code></li>
<li><code><a title="dphon.index.Index.size" href="#dphon.index.Index.size">size</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="dphon.index.LookupsIndex" href="#dphon.index.LookupsIndex">LookupsIndex</a></code></h4>
</li>
<li>
<h4><code><a title="dphon.index.NgramPhonemesLookupsIndex" href="#dphon.index.NgramPhonemesLookupsIndex">NgramPhonemesLookupsIndex</a></code></h4>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>